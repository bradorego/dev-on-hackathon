"use strict";angular.module("africaSmsApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/signIn",{templateUrl:"views/signIn.html",controller:"SignInCtrl"}).when("/signUp",{templateUrl:"views/signUp.html",controller:"SignUpCtrl"}).when("/lists",{templateUrl:"views/lists.html",controller:"ListsCtrl"}).when("/lists/:id",{templateUrl:"views/listView.html",controller:"ListViewCtrl"}).when("/history",{templateUrl:"views/history.html",controller:"HistoryCtrl"}).otherwise({redirectTo:"/"})}]).run(["$location","EverythingFactory","$rootScope",function(a,b,c){b.getUser()._id||a.path("/signIn"),c.signOut=function(){window.location.reload()}}]),angular.module("africaSmsApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("africaSmsApp").controller("HistoryCtrl",["$scope","EverythingFactory",function(a,b){b.getHistory().then(function(b){a.history=b})}]),angular.module("africaSmsApp").controller("ListsCtrl",["$scope","$location","EverythingFactory",function(a,b,c){c.getLists().then(function(b){a.lists=b}),a.goToList=function(a){b.path("/lists/"+a.id)},a.createList=function(){var b=window.prompt("What is this list's name?");b&&c.addList(b).then(function(b){a.lists=b.distributionLists})},a.isModalOpen=!1,a.newMessage=function(){a.isModalOpen=!0},a.messageSent=function(b){c.sendMessage(b.list,b.text).then(function(b){console.log(b),a.isModalOpen=!1})},a.closeModal=function(){a.isModalOpen=!1}}]),angular.module("africaSmsApp").controller("ListViewCtrl",["$scope","$routeParams","EverythingFactory","$location",function(a,b,c,d){c.getListById(b.id).then(function(b){a.list=b,console.log(b)}),a.deleteList=function(){window.confirm("Are you sure you want to delete this list? All numbers will be lost.")&&c.removeList(a.list.id).then(function(){d.path("/lists")})},a.editName=function(){var b=window.prompt("What is this list's name?",a.list.name);b&&c.editList(a.list.id,b).then(function(b){a.list.name=b})},a.addNumber=function(b){b&&c.addNumberToList(a.list.id,b).then(function(b){a.list=b,a.number=""})},a.removeNumber=function(b){window.confirm("Are you sure you want to delete this number?")&&c.removeNumberFromList(a.list.id,b).then(function(b){a.list=b})},a.isModalOpen=!1,a.showModal=function(){a.isModalOpen=!0},a.closeModal=function(){a.isModalOpen=!1},a.messageSent=function(b){window.alert(b),a.isModalOpen=!1}}]),angular.module("africaSmsApp").controller("SignUpCtrl",["$scope",function(a){a.user={email:"",password:""},a.signUp=function(a){console.log(a)}}]),angular.module("africaSmsApp").controller("SignInCtrl",["$scope","$location","EverythingFactory",function(a,b,c){a.user={email:"me@bradorego.com",password:"TestWord"},a.signIn=function(a){c.signIn(a.email,a.password).then(function(a){console.log(a),b.path("/lists")})}}]),angular.module("africaSmsApp").directive("sendModal",function(){var a={};return a.templateUrl="/views/_send_modal.html",a.restrict="EA",a.scope={lists:"=",messageSent:"&onMessageSent",closeModal:"&"},a.controller=function(a){a.message={list:"",text:""}},a}),angular.module("africaSmsApp").factory("EverythingFactory",["$http","$q",function(a,b){var c={},d={};return c.signIn=function(d,e){var f=b.defer();return a.post("http://localhost:5000/signIn",{email:d,password:e}).success(function(a){c.setUser(a),f.resolve(a)}).error(function(a){f.reject(a)}),f.promise},c.setUser=function(a){return d=a},c.getUser=function(){return d},c.addList=function(c){var e=b.defer();return a.post("http://localhost:5000/users/"+d._id+"/lists",{name:c}).success(function(a){d=a,e.resolve(a)}).error(function(a){e.reject(a)}),e.promise},c.editList=function(c,e){var f=b.defer();return a.put("http://localhost:5000/users/"+d._id+"/lists/"+c,{name:e}).success(function(a){f.resolve(a)}).error(function(a){f.reject(a)}),f.promise},c.removeList=function(c){var e=b.defer();return a.delete("http://localhost:5000/users/"+d._id+"/lists/"+c).success(function(a){e.resolve(a)}).error(function(a){e.reject(a)}),e.promise},c.addNumberToList=function(c,e){var f=b.defer();return a.post("http://localhost:5000/users/"+d._id+"/lists/"+c+"/"+e).success(function(a){f.resolve(a)}).error(function(a){f.reject(a)}),f.promise},c.removeNumberFromList=function(c,e){var f=b.defer();return a.delete("http://localhost:5000/users/"+d._id+"/lists/"+c+"/"+e).success(function(a){f.resolve(a)}).error(function(a){f.reject(a)}),f.promise},c.getLists=function(){var c=b.defer();return a.get("http://localhost:5000/users/"+d._id+"/lists").success(function(a){c.resolve(a)}).error(function(a){c.reject(a)}),c.promise},c.getListById=function(c){var e=b.defer();return a.get("http://localhost:5000/users/"+d._id+"/lists/"+c).success(function(a){e.resolve(a)}).error(function(a){e.reject(a)}),e.promise},c.getHistory=function(){var c=b.defer();return a.get("http://localhost:5000/users/"+d._id+"/history").success(function(a){c.resolve(a)}).error(function(a){c.reject(a)}),c.promise},c.sendMessage=function(c,e){var f=b.defer();return a.post("http://localhost:5000/sendMessage",{list:c,userId:d._id,message:e}).success(function(a){f.resolve(a)}).error(function(a){f.reject(a)}),f.promise},c}]);